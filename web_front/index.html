<html lang = "en">
<head>	
    <title>Присоединиться?</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
	<div class="wrapper">
		<form>          
			<input 
			id="inp" 
			class="room" 
			placeholder="Queue PIN" 
			type="tel" 
			shake="" 
			data-functional-selector="" 
			aria-label="" />          
			<button 
			id="but"
			type="submit" 
			class="" 
			blocking="" 
			data-functional-selector="">
			Join          
			</button>      
		</form>
	</div>

	<script 
	type="text/javascript" 
	src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.18.0/axios.js">
	</script>

    <script>
      var token = (() => {
        var output = document.getElementById('output');
        document.getElementById('but').onclick = function (event) {
					event.preventDefault()
          var data = document.getElementById('inp').value;
          axios.post('join', {
          	pin: data
          })
            .then(function (res) {
            	console.log(res);
            })
            .catch(function (err) {
            	console.log(err);
            });
        };
      })();

      window.localStorage.setItem('user_token', token);

      function getqid(href) {
      	var l = document.createElement("a");
      	l.href = href;
      	var str = l.search;
      	var ret = "";
      	for (var i = str.length - 1; str[i] != '=' && i >= 0; --i) {
      		ret += str[i];
      	}
      	if (ret.length == 0) {
      		console.log("Error! ret is empty!");
      	}
      	return ret.split("").reverse().join(""); 
      }

  	  console.log(getqid(document.URL));
    </script>
</body>
</html>